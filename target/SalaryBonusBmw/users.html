<!DOCTYPE html>
<html ng-app="app">
<head>
<meta charset="UTF-8">
<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<title>SDPPB</title>
</head>

<body ng-controller="myangularController">
	<div class="container">
		<h2 class="text-center">Users</h2>
		<div id="next_button" align="right">
			<button type="button" class="btn btn-sm btn-outline-secondary btn-secondary next-button"
				data-toggle="modal" data-target="#agregar">
				<span class="glyphicon glyphicon-plus-sign" style="font-size:35px;color:black;" aria-hidden="true"></span>
			</button>
		</div>
		<br/>
		<table class="table table-striped table-bordered">
			<thead>
				<tr>
					<th>ID User</th>
					<th>Employee Name</th>
					<th>Login User</th>
					<th>Date</th>
					<th>Active</th>
					<th>Role</th>
					<th>Options</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="user in datos">
					<td>{{user.iduser}}</td>
					<td>{{user.employee.firstname}}&nbsp;{{user.employee.lastname}}</td>
					<td>{{user.loginuser}}</td>
					<td>{{user.lastaccess | date:'dd-MM-yyyy'}}</td>
					<td>{{user.active}}</td>
					<td>{{user.role.namerol}}</td>
					<td><label><button type="button" class="btn btn-danger"
						ng-click="desactivaUser(user)"><span class="glyphicon glyphicon-trash"></span></button></label> 
					<label>
							<button type="button" class="btn btn-primary"
								ng-click="findUser(user.iduser)" data-toggle="modal"
								data-target="#modificar"><span class="glyphicon glyphicon-edit"></span></button>
					</label></td>
				</tr>
				
			</tbody>
		</table>		
	</div>

	<!-- Modales -->
	<div class="modal fade" id="modificar" tabindex="-1" role="dialog"
		aria-labelledby="Modificar" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="Modificar">Update User</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<label for="idEmployeeSelect"> ID Employee: </label>
				    <select name="idEmployeeSelect" id="idEmployeeSelect" ng-model="user.employee.idemployee">
				      <option ng-repeat="e in employees" value="{{e.idemployee}}">{{e.firstname}}</option>
				    </select> <br/> 
					<label for="loginUser"> Login User: </label>
					<input id="loginUser" ng-model="user.loginuser" type="text"><br /> 
					<label for="password"> Password: </label>
					<input id="password" ng-model="user.password" type="password"><br />
					<label for="rolSelect"> Role: </label>
					<select name="rolSelect" id="rolSelect" title="asd" ng-model="user.role.idrol">
				      <option ng-repeat="rol in roles" value="{{rol.idrol}}">{{rol.namerol}}</option>
				    </select> <br/>
					<label for="active"> Active: </label>
					<input id="active" ng-model="user.active" type="text"><br />
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-dismiss="modal">Cancel</button>
					<button type="button" ng-click="modificaUser(user.iduser)"
						class="btn btn-primary">Save</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="agregar" tabindex="-1" role="dialog"
		aria-labelledby="Agregar" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="Agregar">Agregar Usuario</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="container">
						<label></label>
						<label for="idEmployeeSelect"> ID Employee: </label>
					    <select name="idEmployeeSelect" id="idEmployeeSelect" ng-model="formData.employee.idemployee">
					      <option ng-repeat="e in employees" value="{{e.idemployee}}">{{e.firstname}}</option>
					    </select> <br/>
						<label for="loginUser"> Login User: </label>
						<input id="loginUser" ng-model="formData.loginuser" type="text"><br /> 
						<label for="password"> Password: </label>
						<input id="password" ng-model="formData.password" type="password"><br />
						<label for="lastAccess"> Date: </label>
						<input type="datetime-local" name="lastAccess" ng-model="formData.lastaccess"><br/>
						<label for="rolSelect"> Role: </label>
						<select name="rolSelect" id="rolSelect" ng-model="formData.role.idrol">
					      <option ng-repeat="rol in roles" value="{{rol.idrol}}">{{rol.namerol}}</option>
					    </select> <br/>
						<label for="active"> Active: </label>
						<input id="active" ng-model="formData.active" type="number"><br />
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-dismiss="modal">Cancel</button>
					<button type="button" ng-click="agregaUser()" class="btn btn-primary">Agregar</button>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
